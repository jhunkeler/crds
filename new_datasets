#! /usr/bin/env pysh
#-*-python-*-

candidate_lines = lines("python get_mast_dataset_ids.py $1 $2")
# print "candidate datasets", candidate_downloads

existing_datasets = [ out("basename $f _raw.fits").strip().upper() for f in \
                          words("ls -1 ../../../datasets | grep -v .pkl | grep -iv hidden") ]
# print "existing datasets", existing_datasets

for line in candidate_lines:
    candidate_ids = [x.strip() for x in line.split()]
    for id in candidate_ids:
        if id in existing_datasets:
            print id, candidate_ids.index(id)
            break
    else:
        print candidate_ids[0]
