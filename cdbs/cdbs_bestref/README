The code basically breaks down like this:

-The pipeline task that reads FITS header keyword values and computes
the best reference file names to use in updating other FITS keywords
(like BIASFILE, DARKFILE, etc.) is bestref.py, and everything it calls.
The pre-archive, OTFR, and reprocessing pipelines all call this task
as HST telemetry "POD" files are processed into FITS files.  It is usually
called shortly before the calibration software.

-The pipeline task that runs periodically (twice a day currently I believe)
and takes care of updating the archive catalog to fill in the various "best"
database fields with up-to-date reference file names
(e.g. archive catalog table acs_ref_data.acr_best_biasfile) is
cdb_new_exposures.csh, and everything it calls.

-The pipeline task that runs as each new set of CDBS reference files is
delivered to the system for use and takes care of updating the archive
catalog to update any affected exposures' "best" database fields with changes
in reference file names 
(e.g. archive catalog table acs_ref_data.acr_best_biasfile)
is cdb_new_reffiles.csh, and everything it calls.

Many of these source modules are called eventually by each of the 3
pipeline tasks.

The reference_file_defs.xml file provides the reference file selection
rules for each instrument and reference file type.  This file is used by
each of the 3 pipeline tasks, or the code they call.

